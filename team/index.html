<!doctype html>
<html>
	<head>
		<title id="title">VEX Data</title>
		<link rel="stylesheet" href="style.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
		<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.blue-red.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
	</head>
	<body>
		<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
			<header class="mdl-layout__header">
				<div class="mdl-layout__header-row">
					<a class="mdl-layout-title mdl-color-text--white" href="../">VEX Data</a>
					<div class="mdl-layout-spacer"></div>
					<nav class="mdl-navigation mdl-layout--large-screen-only">
						<a class="mdl-navigation__link" href="../teams">Teams</a>
						<a class="mdl-navigation__link" href="../events">Events</a>
						<a class="mdl-navigation__link" href="../skills">Skills</a>
					</nav>
					<div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right">
						<label class="mdl-button mdl-js-button mdl-button--icon" for="fixed-header-drawer-exp">
							<i class="material-icons">search</i>
						</label>
						<div class="mdl-textfield__expandable-holder">
							<input class="mdl-textfield__input" type="text" name="sample" id="fixed-header-drawer-exp">
						</div>
					</div>
				</div>
			</header>
			<div class="mdl-layout__drawer mdl-layout--small-screen-only">
				<a class="mdl-layout-title mdl-color-text--grey-800" href="../">VEX Data</a>
				<nav class="mdl-navigation">
					<a class="mdl-navigation__link" href="../teams">Teams</a>
					<a class="mdl-navigation__link" href="../events">Events</a>
					<a class="mdl-navigation__link" href="../skills">Skills</a>
				</nav>
			</div>
			<main class="mdl-layout__content">
				<div class="page-content">
					<h1 class="mdl-layout-title" id="team-title"></h1>
					<div class="mdl-grid">
						<div class="mdl-cell mdl-cell--6-col mdl-cell--top mdl-card mdl-shadow--2dp">
							<div class="mdl-card__title">
								<h2 class="mdl-card__title-text">Info</h2>
							</div>
							<div class="mdl-card__data">
								<table class="mdl-data-table mdl-js-data-table wrappable" id="info-table">
									<tbody>
									</tbody>
								</table>
							</div>
						</div>
						<div class="mdl-cell mdl-cell--6-col mdl-cell--top mdl-card mdl-shadow--2dp">
							<div class="mdl-card__title">
								<h2 class="mdl-card__title-text">Stats</h2>
							</div>
							<div class="mdl-card__data">
								<table class="mdl-data-table mdl-js-data-table" id="stats-table">
									<tbody>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</main>
		</div>
	</body>
</html>

<script>
$(document).ready(function() {
	var url = window.location.href.split(/[&=]/);
	var prog = url[1];
	var id = url[3];
	$.getJSON(`/api/team?prog=${prog}&id=${id}`, function(data) {
		var team = `${decodeProg(data._id.prog)} ${data._id.id}`;
		$('#title').prepend(`${team} | `);
		$('#team-title').append(team);
		var info = tableRow('Name', data.name);
		info += tableRow('Organization', data.org);
		info += tableRow('Location', getLocation(data.city, data.region, data.country));
		info += tableRow('Grade', decodeGrade(data.grade));
		info += tableRow('Robot', data.robot);
		$('#info-table > tbody').append(info);
	});
});

function tableRow(key, value) {
	return `<tr><td class="mdl-data-table__cell--non-numeric"><strong>${key}</strong></td><td class="mdl-data-table__cell--non-numeric">${value === undefined ? '' : value}</td></tr>`;
}

function getLocation(city, region, country) {
	var location = [city];
	if (region) {
		location.push(region);
	}
	if (country) {
		location.push(country);
	}
	return location.join(', ');
}

var progs = {
	1: 'VRC',
	4: 'VEXU',
	37: 'CREATE',
	40: 'WORKSHOP',
	41: 'VIQC'
};

var grades = [
	'All',
	'Elementary',
	'Middle School',
	'High School',
	'College'
];

function decodeProg(prog) {
	return progs[prog];
}

function decodeGrade(grade) {
	return grades[grade];
}
</script>
